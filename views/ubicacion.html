<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nuestras Tiendas - TechStore</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Fuentes Google (Inter) -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Leaflet CSS (Mapa) -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        slate: {
                            850: '#1e293b',
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body {
            font-family: 'Inter', sans-serif;
            -webkit-font-smoothing: antialiased;
        }
        /* Estilos para el mapa */
        #map {
            height: 100%;
            width: 100%;
            z-index: 10;
        }
        /* Personalizaci칩n de la tarjeta activa en la lista */
        .store-card.active {
            border-color: #4F46E5; /* Indigo 600 */
            background-color: #F8FAFC; /* Slate 50 */
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        .store-card.active .store-icon {
            background-color: #4F46E5;
            color: white;
        }
        /* Ajuste visual para el popup de Leaflet */
        .leaflet-popup-content-wrapper {
            border-radius: 0.75rem; /* rounded-xl */
            padding: 0;
            overflow: hidden;
        }
        .leaflet-popup-content {
            margin: 0;
            width: 260px !important;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800 flex flex-col h-screen">

    <!-- --- HEADER (Consistente) --- -->
    <header class="bg-[#0B1120] text-white sticky top-0 z-50 shadow-lg flex-shrink-0">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 w-full">
            <div class="flex justify-between items-center h-20">
                <!-- Logo -->
                <div class="flex items-center gap-2 cursor-pointer">
                    <div class="bg-indigo-600 p-1.5 rounded-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="4" y="4" width="16" height="16" rx="2" ry="2"></rect><rect x="9" y="9" width="6" height="6"></rect><line x1="9" y1="1" x2="9" y2="4"></line><line x1="15" y1="1" x2="15" y2="4"></line><line x1="9" y1="20" x2="9" y2="23"></line><line x1="15" y1="20" x2="15" y2="23"></line><line x1="20" y1="9" x2="23" y2="9"></line><line x1="20" y1="14" x2="23" y2="14"></line><line x1="1" y1="9" x2="4" y2="9"></line><line x1="1" y1="14" x2="4" y2="14"></line></svg>
                    </div>
                    <div class="flex flex-col leading-none">
                        <span class="text-xl font-bold tracking-tight">TechStore</span>
                        <span class="text-[10px] text-gray-400 uppercase tracking-widest">Modular System</span>
                    </div>
                </div>

                <!-- Nav Links -->
                <nav class="hidden md:flex items-center gap-8 text-sm font-medium text-gray-300">
                    <a href="/index.html" class="hover:text-white transition-colors">Inicio</a>
                    <a href="/index.html" class="hover:text-white transition-colors">Productos</a>
                    <a href="/views/ubicacion.html" class="text-white font-semibold border-b-2 border-indigo-400 pb-0.5">Tiendas</a>
                    <a href="/index.html" class="text-white flex items-center gap-1">Ofertas <span class="text-orange-500">游댠</span></a>
                    <a href="/views/vip_access.html" class="hover:text-white transition-colors">VIP</a>
                    <a href="/views/centro_ayuda.html" class="hover:text-white transition-colors">Ayuda</a>
                </nav>

                <!-- Icons -->
                <div class="flex items-center gap-6 text-gray-300">
                    <button class="hover:text-white transition-colors"><i class="fa-solid fa-magnifying-glass"></i></button>
                    <button class="hover:text-white transition-colors relative">
                        <i class="fa-solid fa-cart-shopping"></i>
                        <span class="absolute -top-2 -right-2 bg-indigo-600 text-white text-[10px] font-bold w-4 h-4 rounded-full flex items-center justify-center">2</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- --- MAIN LAYOUT (Full Height) --- -->
    <div class="flex flex-col lg:flex-row flex-grow overflow-hidden relative">
        
        <!-- Sidebar: Store List -->
        <div class="w-full lg:w-1/3 bg-white border-r border-slate-200 overflow-y-auto z-20 flex flex-col shadow-xl">
            <!-- Header Sidebar -->
            <div class="p-6 border-b border-slate-100 bg-white sticky top-0 z-10">
                <span class="text-indigo-600 font-bold tracking-wider uppercase text-xs mb-1 block">Encu칠ntranos</span>
                <h1 class="text-2xl font-extrabold text-slate-900">Nuestras 10 Tiendas</h1>
                <p class="text-slate-500 text-sm mt-1">Vis칤tanos y prueba los equipos en persona.</p>
                
                <!-- Search Box -->
                <div class="mt-4 relative">
                    <i class="fa-solid fa-location-dot absolute left-3 top-3 text-slate-400"></i>
                    <input type="text" placeholder="Buscar distrito (ej. Megaplaza)..." class="w-full pl-10 pr-4 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 transition-all" id="searchInput">
                </div>
            </div>

            <!-- Listado de Tiendas -->
            <div class="p-4 space-y-4" id="storeList">
                <!-- Se llenar치 con JS -->
            </div>

            <!-- Footer Sidebar -->
            <div class="mt-auto p-6 bg-slate-50 border-t border-slate-200 text-center">
                <p class="text-xs text-slate-500 mb-2">쯅o puedes venir?</p>
                <button class="w-full py-2 bg-slate-900 text-white rounded-lg text-sm font-medium hover:bg-slate-800 transition-colors">
                    Compra Online con Env칤o Gratis
                </button>
            </div>
        </div>

        <!-- Map Area -->
        <div class="w-full lg:w-2/3 bg-slate-100 relative h-[50vh] lg:h-auto">
            <div id="map"></div>
            
            <!-- Floating Controls (Custom) -->
            <div class="absolute bottom-6 right-6 z-[1000] flex flex-col gap-2">
                <button class="bg-white p-3 rounded-full shadow-lg hover:bg-indigo-50 text-slate-600 transition-all" onclick="resetMap()" title="Centrar mapa">
                    <i class="fa-solid fa-crosshairs"></i>
                </button>
            </div>
        </div>

    </div>

    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

    <script>
        // --- DATOS DE LAS 10 TIENDAS ---
        // URLs actualizadas y verificadas para asegurar que carguen siempre
        const stores = [
            {
                id: 1,
                name: "TechStore MegaPlaza",
                address: "Av. Alfredo Mendiola 3698, Independencia",
                hours: "Lun-Dom: 10am - 10pm",
                phone: "(01) 521-9999",
                coords: [-11.993927, -77.060989],
                badge: "Nuevo",
                // Fachada moderna de centro comercial
                image: "https://images.unsplash.com/photo-1567401893414-76b7b1e5a7a5?q=80&w=600&auto=format&fit=crop"
            },
            {
                id: 2,
                name: "TechStore Miraflores (Flagship)",
                address: "Av. Petit Thouars 5356, Miraflores",
                hours: "Lun-Sab: 10am - 8pm",
                phone: "(01) 445-1234",
                coords: [-12.119566, -77.029285],
                badge: "Principal",
                // Interior futurista / Gaming
                image: "https://images.unsplash.com/photo-1542751371-adc38448a05e?q=80&w=600&auto=format&fit=crop"
            },
            {
                id: 3,
                name: "TechStore Centro C칤vico",
                address: "Av. Garcilaso de la Vega 1348, Lima",
                hours: "Lun-Dom: 9am - 9pm",
                phone: "(01) 332-5678",
                coords: [-12.056345, -77.037164],
                badge: "Outlet",
                // Estilo tienda de componentes
                image: "https://images.pexels.com/photos/2582937/pexels-photo-2582937.jpeg?auto=compress&cs=tinysrgb&w=600"
            },
            {
                id: 4,
                name: "TechStore Jockey Plaza",
                address: "Av. Javier Prado Este 4200, Surco",
                hours: "Lun-Dom: 11am - 10pm",
                phone: "(01) 437-1122",
                coords: [-12.086392, -76.975765],
                badge: "Premium",
                // Tienda estilo minimalista / Apple
                image: "https://images.unsplash.com/photo-1556228453-efd6c1ff04f6?q=80&w=600&auto=format&fit=crop"
            },
            {
                id: 5,
                name: "TechStore Plaza Norte",
                address: "Av. Tom치s Valle, Independencia",
                hours: "Lun-Dom: 10am - 10pm",
                phone: "(01) 521-8888",
                coords: [-12.006577, -77.059037],
                badge: null,
                // Interior de tienda tech (Imagen actualizada)
                image: "https://images.pexels.com/photos/8533348/pexels-photo-8533348.jpeg?auto=compress&cs=tinysrgb&w=600"
            },
            {
                id: 6,
                name: "TechStore Plaza San Miguel",
                address: "Av. La Marina 2000, San Miguel",
                hours: "Lun-Dom: 10am - 10pm",
                phone: "(01) 566-3333",
                coords: [-12.076758, -77.084385],
                badge: "Remodelado",
                // Fachada de cristal
                image: "https://images.pexels.com/photos/1036808/pexels-photo-1036808.jpeg?auto=compress&cs=tinysrgb&w=600"
            },
            {
                id: 7,
                name: "TechStore Mall del Sur",
                address: "Av. Los Lirios, San Juan de Miraflores",
                hours: "Lun-Dom: 10am - 10pm",
                phone: "(01) 276-4444",
                coords: [-12.156372, -76.985793],
                badge: null,
                // Pasillo comercial iluminado
                image: "https://images.pexels.com/photos/264507/pexels-photo-264507.jpeg?auto=compress&cs=tinysrgb&w=600"
            },
            {
                id: 8,
                name: "TechStore Real Plaza Salaverry",
                address: "Av. Gral. Salaverry 2370, Jes칰s Mar칤a",
                hours: "Lun-Dom: 10am - 9:30pm",
                phone: "(01) 471-5555",
                coords: [-12.089332, -77.051724],
                badge: "Premium",
                // Tienda moderna y limpia (Imagen actualizada)
                image: "https://images.pexels.com/photos/374016/pexels-photo-374016.jpeg?auto=compress&cs=tinysrgb&w=600"
            },
            {
                id: 9,
                name: "TechStore La Rambla San Borja",
                address: "Av. Javier Prado Este 2050, San Borja",
                hours: "Lun-Dom: 10am - 10pm",
                phone: "(01) 225-6666",
                coords: [-12.089828, -77.003453],
                badge: null,
                // Mostrador tech
                image: "https://images.unsplash.com/photo-1550009158-9ebf69173e03?q=80&w=600&auto=format&fit=crop"
            },
            {
                id: 10,
                name: "TechStore Mall Aventura Santa Anita",
                address: "Carr. Central 111, Santa Anita",
                hours: "Lun-Dom: 10am - 10pm",
                phone: "(01) 362-7777",
                coords: [-12.053912, -76.962189],
                badge: null,
                // Cliente en tienda
                image: "https://images.unsplash.com/photo-1556740749-887f6717d7e4?q=80&w=600&auto=format&fit=crop"
            }
        ];

        // --- INICIALIZAR MAPA ---
        // Coordenadas centrales de Lima
        const map = L.map('map', {
            zoomControl: false
        }).setView([-12.06, -77.04], 12);

        // A침adir capa de OpenStreetMap (Estilo CartoDB Voyager - muy limpio)
        L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="https://carto.com/attributions">CARTO</a>',
            subdomains: 'abcd',
            maxZoom: 20
        }).addTo(map);
        
        L.control.zoom({ position: 'topright' }).addTo(map);

        // Icono personalizado (Estilo TechStore)
        const techIcon = L.divIcon({
            className: 'custom-div-icon',
            html: `<div style="background-color: #4F46E5; width: 30px; height: 30px; border-radius: 50%; border: 3px solid white; box-shadow: 0 4px 6px rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center;">
                    <i class="fa-solid fa-shop" style="color: white; font-size: 14px;"></i>
                   </div>`,
            iconSize: [30, 30],
            iconAnchor: [15, 15],
            popupAnchor: [0, -15]
        });

        // --- RENDERIZAR MARCADORES Y LISTA ---
        const storeList = document.getElementById('storeList');
        const markers = {};

        // Funci칩n para pintar la lista
        function renderStoreList(storesToRender) {
            storeList.innerHTML = '';
            storesToRender.forEach(store => {
                const card = document.createElement('div');
                card.className = `store-card p-4 rounded-xl border border-slate-200 cursor-pointer transition-all hover:border-indigo-300 hover:bg-slate-50 animate-fade-in`;
                card.onclick = () => selectStore(store.id);
                card.id = `store-card-${store.id}`;

                card.innerHTML = `
                    <div class="flex items-start gap-4">
                        <div class="store-icon w-10 h-10 rounded-full bg-slate-100 flex items-center justify-center text-slate-500 transition-colors mt-1 flex-shrink-0">
                            <i class="fa-solid fa-store"></i>
                        </div>
                        <div class="flex-1">
                            <div class="flex justify-between items-start">
                                <h3 class="font-bold text-slate-800 text-sm">${store.name}</h3>
                                ${store.badge ? `<span class="bg-indigo-100 text-indigo-700 text-[10px] font-bold px-2 py-0.5 rounded-full uppercase tracking-wide">${store.badge}</span>` : ''}
                            </div>
                            <p class="text-slate-500 text-xs mt-1 leading-relaxed"><i class="fa-solid fa-location-dot mr-1 w-3"></i> ${store.address}</p>
                            <div class="flex items-center gap-4 mt-3 text-xs text-slate-600">
                                <span class="flex items-center gap-1"><i class="fa-regular fa-clock text-slate-400"></i> ${store.hours}</span>
                                <span class="flex items-center gap-1"><i class="fa-solid fa-phone text-slate-400"></i> ${store.phone}</span>
                            </div>
                        </div>
                    </div>
                `;
                storeList.appendChild(card);
            });
        }

        // Inicializar Marcadores en Mapa
        stores.forEach(store => {
            // Popup personalizado CON IMAGEN
            const popupContent = `
                <div class="flex flex-col font-sans bg-white">
                    <div class="h-32 w-full overflow-hidden bg-gray-200 relative">
                        <img src="${store.image}" alt="${store.name}" class="w-full h-full object-cover transition-transform duration-700 hover:scale-110">
                        ${store.badge ? `<span class="absolute top-2 right-2 bg-indigo-600 text-white text-[10px] font-bold px-2 py-1 rounded shadow-sm">${store.badge}</span>` : ''}
                    </div>
                    <div class="p-4">
                        <h3 class="font-bold text-indigo-700 text-sm mb-1 uppercase tracking-wide">${store.name}</h3>
                        <p class="text-xs text-gray-600 mb-3 leading-relaxed border-b border-gray-100 pb-2">${store.address}</p>
                        
                        <div class="grid grid-cols-2 gap-2 mb-3">
                            <div class="text-[10px] text-gray-500 flex items-center gap-1">
                                <i class="fa-regular fa-clock text-indigo-500"></i> ${store.hours}
                            </div>
                            <div class="text-[10px] text-gray-500 flex items-center gap-1">
                                <i class="fa-solid fa-phone text-indigo-500"></i> ${store.phone}
                            </div>
                        </div>

                        <a href="https://www.google.com/maps/search/?api=1&query=${store.coords[0]},${store.coords[1]}" target="_blank" class="block w-full text-center bg-slate-900 text-white text-xs font-bold py-2 rounded hover:bg-indigo-600 transition-colors">
                            C칩mo llegar <i class="fa-solid fa-location-arrow ml-1"></i>
                        </a>
                    </div>
                </div>
            `;

            const marker = L.marker(store.coords, { icon: techIcon }).addTo(map);
            marker.bindPopup(popupContent, { minWidth: 240, maxWidth: 240 });
            markers[store.id] = marker;
        });

        // Render inicial
        renderStoreList(stores);

        // --- L칍GICA DE INTERACCI칍N ---
        function selectStore(id) {
            const store = stores.find(s => s.id === id);
            
            // 1. Mover mapa con zoom suave
            map.flyTo(store.coords, 16, {
                animate: true,
                duration: 1.5
            });

            // 2. Abrir Popup autom치ticamente
            setTimeout(() => {
                markers[id].openPopup();
            }, 800);

            // 3. Actualizar estilos de la lista (Active state)
            document.querySelectorAll('.store-card').forEach(el => el.classList.remove('active'));
            document.getElementById(`store-card-${id}`).classList.add('active');
            
            // Scroll en m칩vil
            if (window.innerWidth < 1024) {
               window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function resetMap() {
            map.flyTo([-12.06, -77.04], 11);
            map.closePopup();
            document.querySelectorAll('.store-card').forEach(el => el.classList.remove('active'));
        }

        // Buscador simple
        document.getElementById('searchInput').addEventListener('input', (e) => {
            const term = e.target.value.toLowerCase();
            const filtered = stores.filter(s => 
                s.name.toLowerCase().includes(term) || 
                s.address.toLowerCase().includes(term)
            );
            renderStoreList(filtered);
        });

    </script>
</body>
</html>